# Как сохранить статистику, доступы и ссылку при редиплое (Railway)

Сейчас бот пишет базу в файл `bot.db` внутри контейнера. При каждом редиплое контейнер создаётся заново и файл пропадает — сбрасываются пользователи, доступы и реферальная ссылка.

Чтобы данные **не сбрасывались**, нужно хранить базу на **Volume** (постоянный диск) в Railway.

---

## Шаги в Railway

### 1. Создать Volume

1. Зайди в **Railway** → открой свой проект и сервис бота.
2. Вкладка **Variables** или в боковой панели найди **Volumes** (или **Storage**).
3. Нажми **+ New Volume** / **Add Volume**.
4. Укажи:
   - **Mount Path:** `/data`  
     (папка в контейнере, куда будет смонтирован диск)
   - Имя тома можно оставить по умолчанию или задать своё, например `bot-data`.
5. Сохрани (Create / Add).

### 2. Добавить переменную окружения

1. В том же сервисе открой **Variables**.
2. Добавь переменную:
   - **Name:** `DATABASE_PATH`
   - **Value:** `/data/bot.db`
3. Сохрани переменные.

### 3. Передеплой

Сделай **Redeploy** сервиса (или дождись следующего деплоя). После перезапуска бот будет писать базу в `/data/bot.db`, а эта папка лежит на Volume и **не пропадает** при редиплое.

---

## Что в итоге

- **Статистика** (пользователи, кто с доступом) — в БД на Volume, сохраняется.
- **Реферальная ссылка** (которую задаёшь через `/setref`) — в той же БД, сохраняется.
- **Постбэки** (таблица постбэков) — тоже в этой БД, сохраняются.

При следующих редиплоях контейнер поднимется заново, но подключится к тому же файлу `/data/bot.db` на Volume — данные останутся.

---

## Если Volume уже был, но переменной не было

Если Volume смонтирован, но переменная `DATABASE_PATH` не была задана, бот до этого писал в `bot.db` в текущей папке (внутри контейнера), и при редиплое эти данные терялись. После того как добавишь `DATABASE_PATH=/data/bot.db` и передеплоишь, бот начнёт писать в `/data/bot.db`. Старых данных не будет — они были в старом контейнере. Зато **с этого момента** статистика, доступы и ссылка будут сохраняться при каждом редиплое.
