# Подробно: как добавить Volume и сохранить базу на Railway

По шагам — куда заходить, что нажимать, что вводить.

---

## Часть 1. Создать Volume (постоянный диск)

### Шаг 1.1. Открыть проект и сервис

1. Зайди на **https://railway.app** и войди в аккаунт.
2. Открой **свой проект** (тот, где деплоится бот).
3. Кликни по **сервису бота** (карточка с названием репозитория, например tower31) — откроется страница этого сервиса.

### Шаг 1.2. Открыть создание Volume (нет отдельной вкладки)

В Railway Volume создаётся **не через вкладку**, а через **палитру команд** или **правый клик** по холсту:

**Способ А — палитра команд:**
1. Открой страницу **проекта** (где видны сервисы — карточки).
2. Нажми **Ctrl+K** (Windows) или **Cmd+K** (Mac) — откроется палитра команд.
3. Введи **Volume** или **Create Volume**, выбери пункт **Create Volume** / **Add Volume**.

**Способ Б — правый клик:**
1. На странице проекта нажми **правой кнопкой** по **пустому месту** (холст, не по карточке сервиса).
2. В меню выбери **Create Volume** или **Add Volume**.

### Шаг 1.3. Создать Volume и привязать к сервису

1. Railway попросит **выбрать сервис** — выбери сервис бота (tower31 или как он называется).
2. Укажи **Mount Path**: введи **ровно** `/data` (латиницей, слэш в начале).
3. Имя тома (Name) можно оставить по умолчанию или задать, например `bot-data`.
4. Подтверди (**Create** / **Add**). Volume создастся и привяжется к сервису.
5. На холсте может появиться иконка/блок Volume рядом с сервисом.

Volume готов — при редиплое папка `/data` внутри контейнера будет сохраняться.

---

## Часть 2. Добавить переменную DATABASE_PATH

### Шаг 2.1. Открыть Variables

1. В том же сервисе бота открой вкладку **Variables** (Переменные).
2. Увидишь список переменных (BOT_TOKEN, ADMIN_ID и т.д.).

### Шаг 2.2. Создать новую переменную

1. Нажми **+ New Variable** или **Add Variable** или **Raw Editor** (если предпочитаешь ввести всё текстом).
2. Если добавляешь по одной переменной:
   - **Name** (или **Key**): введи **ровно** `DATABASE_PATH` (без пробелов, большими буквами).
   - **Value** (или **Value**): введи **ровно** `/data/bot.db` (без пробелов, латиницей).
3. Сохрани переменную (**Save** / **Add**).
4. Убедись, что в списке есть строка: `DATABASE_PATH` = `/data/bot.db`.

Готово — бот будет использовать базу по пути `/data/bot.db`, то есть на Volume.

---

## Часть 3. Передеплой

1. Открой вкладку **Deployments**.
2. Найди последний деплой (верхний в списке).
3. Справа от него нажми на **три точки (⋮)** или кнопку **Redeploy**.
4. Выбери **Redeploy** (или **Redeploy** в меню).
5. Подтверди, если спросит.
6. Дождись окончания деплоя (статус станет зелёным / **Success**).

После редиплоя контейнер поднимется с Volume, смонтированным в `/data`, и переменной `DATABASE_PATH=/data/bot.db`. Бот начнёт писать базу в `/data/bot.db` — эта папка на постоянном диске, при следующих редиплоях данные не пропадут.

---

## Краткий чеклист

- [ ] Railway → проект → сервис бота.
- [ ] Вкладка **Volumes** (или Settings → Volumes).
- [ ] **+ New Volume** → Mount Path: `/data` → Create/Add.
- [ ] Вкладка **Variables** → **+ New Variable** → Name: `DATABASE_PATH`, Value: `/data/bot.db` → Save.
- [ ] Вкладка **Deployments** → **Redeploy** последнего деплоя.
- [ ] Дождаться успешного деплоя.

После этого статистика, доступы и реферальная ссылка будут сохраняться при каждом редиплое.

---

## Если не находишь Volumes

В Railway интерфейс иногда меняется. Варианты:

1. **Settings** сервиса — прокрути вниз, ищи блок **Volumes** или **Persistent Storage**.
2. В левой панели проекта — иногда Volumes есть как отдельный пункт для сервиса.
3. Документация Railway: в поиске на сайте railway.app введи "Volume" или "Persistent storage" — там будет актуальная инструкция с скринами.

Главное: создать Volume с **Mount Path** = `/data` и переменную **DATABASE_PATH** = `/data/bot.db`, затем сделать Redeploy.

---

## Если всё равно нет возможности создать Volume

- На **Free** плане Railway даёт **1 Volume** на проект — лимит есть, но создаётся он только через **Ctrl+K** (Cmd+K) или **правый клик по холсту**, а не через отдельную вкладку.
- Если интерфейс изменился: зайди в [документацию Railway — Volumes](https://docs.railway.app/guides/volumes) и сверься с актуальными скринами.
- Альтернатива: подключить **PostgreSQL** в Railway и перевести бота на него — тогда данные хранятся в БД Railway и не сбрасываются. Это уже смена кода (замена SQLite на PostgreSQL).
